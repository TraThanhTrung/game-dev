@page "{id:int}"
@model GameServer.Areas.Admin.Pages.GameSections.DetailsModel
@{
    ViewData["Title"] = "Game Section Details";
}

@if (Model.GameSection == null)
{
    <div class="alert alert-danger">
        <i class="mdi mdi-alert-circle"></i>
        Game Section not found.
    </div>
    return;
}

<div class="page-header">
    <h3 class="page-title">Game Section Details</h3>
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a asp-area="Admin" asp-page="/Index">Dashboard</a></li>
            <li class="breadcrumb-item"><a asp-area="Admin" asp-page="/GameSections/Index">Game Sections</a></li>
            <li class="breadcrumb-item active" aria-current="page">Details</li>
        </ol>
    </nav>
</div>

<!-- Overview Cards -->
<div class="row">
    <div class="col-md-4 grid-margin stretch-card">
        <div class="card">
            <div class="card-body">
                <div class="d-flex align-items-center justify-content-between">
                    <div>
                        <h4 class="card-title mb-2">@Model.GameSection.Name</h4>
                        <p class="text-muted mb-0">
                            @if (Model.GameSection.IsActive)
                            {
                                <span class="badge badge-success">Active</span>
                            }
                            else
                            {
                                <span class="badge badge-danger">Inactive</span>
                            }
                        </p>
                    </div>
                    <div class="icon icon-box-primary">
                        <span class="mdi mdi-map icon-item"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-4 grid-margin stretch-card">
        <div class="card">
            <div class="card-body">
                <div class="d-flex align-items-center justify-content-between">
                    <div>
                        <h4 class="card-title mb-2">@Model.GameSection.EnemyCount Enemies</h4>
                        <p class="text-muted mb-0">
                            <i class="mdi mdi-sword-cross"></i>
                            Level @Model.GameSection.EnemyLevel
                        </p>
                        <p class="text-muted mb-0 mt-1">
                            <i class="mdi mdi-timer"></i>
                            @if (Model.GameSection.Duration.HasValue)
                            {
                                <text>@Model.GameSection.Duration.Value.ToString(@"hh\:mm\:ss")</text>
                            }
                            else
                            {
                                <text>Unlimited</text>
                            }
                        </p>
                    </div>
                    <div class="icon icon-box-danger">
                        <span class="mdi mdi-sword icon-item"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-4 grid-margin stretch-card">
        <div class="card">
            <div class="card-body">
                <div class="d-flex align-items-center justify-content-between">
                    <div>
                        <h4 class="card-title mb-2">Spawn Rate</h4>
                        <p class="text-muted mb-0">
                            <i class="mdi mdi-pulse"></i>
                            @Model.GameSection.SpawnRate per second
                        </p>
                        <p class="text-muted mb-0 mt-1">
                            <i class="mdi mdi-calendar"></i>
                            Created: @Model.GameSection.CreatedAt.ToString("yyyy-MM-dd")
                        </p>
                    </div>
                    <div class="icon icon-box-warning">
                        <span class="mdi mdi-speedometer icon-item"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Detailed Information -->
<div class="row">
    <div class="col-md-6 grid-margin stretch-card">
        <div class="card">
            <div class="card-body">
                <h4 class="card-title mb-4">
                    <i class="mdi mdi-information"></i>
                    Basic Information
                </h4>

                <div class="row mb-3">
                    <div class="col-5">
                        <label class="text-muted small">
                            <i class="mdi mdi-identifier"></i>
                            Section ID
                        </label>
                    </div>
                    <div class="col-7">
                        <p class="mb-0 font-weight-medium">
                            <code class="text-primary">@Model.GameSection.SectionId</code>
                        </p>
                    </div>
                </div>
                <hr>

                <div class="row mb-3">
                    <div class="col-5">
                        <label class="text-muted small">
                            <i class="mdi mdi-label"></i>
                            Name
                        </label>
                    </div>
                    <div class="col-7">
                        <p class="mb-0 font-weight-medium">
                            <i class="mdi mdi-map-marker"></i>
                            @Model.GameSection.Name
                        </p>
                    </div>
                </div>
                <hr>

                <div class="row mb-3">
                    <div class="col-5">
                        <label class="text-muted small">
                            <i class="mdi mdi-text"></i>
                            Description
                        </label>
                    </div>
                    <div class="col-7">
                        <p class="mb-0">
                            @(Model.GameSection.Description ?? "No description provided")
                        </p>
                    </div>
                </div>
                <hr>

                <div class="row mb-3">
                    <div class="col-5">
                        <label class="text-muted small">
                            <i class="mdi mdi-flag"></i>
                            Status
                        </label>
                    </div>
                    <div class="col-7">
                        @if (Model.GameSection.IsActive)
                        {
                            <span class="badge badge-success badge-pill">
                                <i class="mdi mdi-check-circle"></i>
                                Active
                            </span>
                        }
                        else
                        {
                            <span class="badge badge-danger badge-pill">
                                <i class="mdi mdi-close-circle"></i>
                                Inactive
                            </span>
                        }
                    </div>
                </div>
                <hr>

                <div class="row">
                    <div class="col-5">
                        <label class="text-muted small">
                            <i class="mdi mdi-calendar-clock"></i>
                            Created At
                        </label>
                    </div>
                    <div class="col-7">
                        <p class="mb-0">
                            <i class="mdi mdi-calendar"></i>
                            @Model.GameSection.CreatedAt.ToString("yyyy-MM-dd HH:mm:ss")
                        </p>
                    </div>
                </div>
                @if (Model.GameSection.UpdatedAt.HasValue)
                {
                    <hr>
                    <div class="row">
                        <div class="col-5">
                            <label class="text-muted small">
                                <i class="mdi mdi-calendar-edit"></i>
                                Updated At
                            </label>
                        </div>
                        <div class="col-7">
                            <p class="mb-0">
                                <i class="mdi mdi-calendar-check"></i>
                                @Model.GameSection.UpdatedAt.Value.ToString("yyyy-MM-dd HH:mm:ss")
                            </p>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>

    <!-- Enemy Configuration -->
    <div class="col-md-6 grid-margin stretch-card">
        <div class="card">
            <div class="card-body">
                <h4 class="card-title mb-4">
                    <i class="mdi mdi-sword-cross"></i>
                    Enemy Configuration
                </h4>

                <div class="row mb-3">
                    <div class="col-5">
                        <label class="text-muted small">
                            <i class="mdi mdi-identifier"></i>
                            Enemy Type ID
                        </label>
                    </div>
                    <div class="col-7">
                        <p class="mb-0 font-weight-medium">
                            @if (!string.IsNullOrEmpty(Model.GameSection.EnemyTypeId))
                            {
                                <code class="text-info">@Model.GameSection.EnemyTypeId</code>
                            }
                            else
                            {
                                <span class="text-muted">N/A</span>
                            }
                        </p>
                    </div>
                </div>
                <hr>

                <div class="row mb-3">
                    <div class="col-5">
                        <label class="text-muted small">
                            <i class="mdi mdi-counter"></i>
                            Enemy Count
                        </label>
                    </div>
                    <div class="col-7">
                        <p class="mb-0 font-weight-medium">
                            <span class="badge badge-danger badge-pill">
                                <i class="mdi mdi-account-group"></i>
                                @Model.GameSection.EnemyCount
                            </span>
                        </p>
                    </div>
                </div>
                <hr>

                <div class="row mb-3">
                    <div class="col-5">
                        <label class="text-muted small">
                            <i class="mdi mdi-star"></i>
                            Enemy Level
                        </label>
                    </div>
                    <div class="col-7">
                        <p class="mb-0 font-weight-medium">
                            <span class="badge badge-warning badge-pill">
                                Level @Model.GameSection.EnemyLevel
                            </span>
                        </p>
                    </div>
                </div>
                <hr>

                <div class="row mb-3">
                    <div class="col-5">
                        <label class="text-muted small">
                            <i class="mdi mdi-pulse"></i>
                            Spawn Rate
                        </label>
                    </div>
                    <div class="col-7">
                        <p class="mb-0 font-weight-medium">
                            <i class="mdi mdi-speedometer"></i>
                            @Model.GameSection.SpawnRate <small class="text-muted">per second</small>
                        </p>
                    </div>
                </div>
                <hr>

                <div class="row">
                    <div class="col-5">
                        <label class="text-muted small">
                            <i class="mdi mdi-timer"></i>
                            Duration
                        </label>
                    </div>
                    <div class="col-7">
                        <p class="mb-0 font-weight-medium">
                            @if (Model.GameSection.Duration.HasValue)
                            {
                                var duration = TimeSpan.FromSeconds(Model.GameSection.Duration.Value);
                                <i class="mdi mdi-clock-outline"></i>
                                @duration.ToString(@"hh\:mm\:ss")
                            }
                            else
                            {
                                <span class="badge badge-info">
                                    <i class="mdi mdi-infinity"></i>
                                    Unlimited
                                </span>
                            }
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Checkpoints List -->
<div class="row mt-3">
    <div class="col-12 grid-margin stretch-card">
        <div class="card">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h4 class="card-title">
                        <i class="mdi mdi-map-marker-multiple"></i>
                        Checkpoints (@Model.Checkpoints.Count)
                    </h4>
                    <a asp-area="Admin" asp-page="/Checkpoints/Create" asp-route-sectionId="@Model.GameSection.SectionId" class="btn btn-success">
                        <i class="mdi mdi-plus"></i> Add Checkpoint
                    </a>
                </div>
                
                @if (Model.Checkpoints.Any())
                {
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Name</th>
                                    <th>Position (X, Y)</th>
                                    <th>Enemy Pool</th>
                                    <th>Max Enemies</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var checkpoint in Model.Checkpoints)
                                {
                                    <tr>
                                        <td>@checkpoint.CheckpointId</td>
                                        <td>@checkpoint.CheckpointName</td>
                                        <td>(@checkpoint.X, @checkpoint.Y)</td>
                                        <td><code>@checkpoint.EnemyPool</code></td>
                                        <td>@checkpoint.MaxEnemies</td>
                                        <td>
                                            @if (checkpoint.IsActive)
                                            {
                                                <span class="badge badge-success">Active</span>
                                            }
                                            else
                                            {
                                                <span class="badge badge-secondary">Inactive</span>
                                            }
                                        </td>
                                        <td>
                                            <a asp-area="Admin" asp-page="/Checkpoints/Edit" asp-route-id="@checkpoint.CheckpointId" class="btn btn-sm btn-primary">
                                                <i class="mdi mdi-pencil"></i> Edit
                                            </a>
                                            <a asp-area="Admin" asp-page="/Checkpoints/Delete" asp-route-id="@checkpoint.CheckpointId" class="btn btn-sm btn-danger">
                                                <i class="mdi mdi-delete"></i> Delete
                                            </a>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                }
                else
                {
                    <div class="alert alert-info">
                        <i class="mdi mdi-information"></i>
                        No checkpoints found for this GameSection. 
                        <a asp-area="Admin" asp-page="/Checkpoints/Create" asp-route-sectionId="@Model.GameSection.SectionId" class="alert-link">Create one now</a>.
                    </div>
                }
            </div>
        </div>
    </div>
</div>

<!-- Action Buttons -->
<div class="row mt-3">
    <div class="col-12">
        <a asp-area="Admin" asp-page="/GameSections/Edit" asp-route-id="@Model.GameSection.SectionId"
            class="btn btn-primary">
            <i class="mdi mdi-pencil"></i>
            Edit Game Section
        </a>
        <a asp-area="Admin" asp-page="/Checkpoints/Index" asp-route-sectionId="@Model.GameSection.SectionId" class="btn btn-success">
            <i class="mdi mdi-map-marker"></i>
            Manage All Checkpoints
        </a>
        <a asp-area="Admin" asp-page="/GameSections/Index" class="btn btn-secondary">
            <i class="mdi mdi-arrow-left"></i>
            Back to Game Sections List
        </a>
    </div>
</div>
